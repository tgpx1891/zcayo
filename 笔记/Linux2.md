## Linux下的一些指令

### 查看端口号

```
netstat –tunlp|grep 端口号
lsof -i:端口号
```

lsof file_name 查看文件占用进程情况

### find命令

用来在指定目录下查找文件。任何位于参数之前的字符串都将被视为欲查找的目录名。如果使用该命令时，不设置任何参数，则find命令将在当前目录下查找子目录与文件。并且将查找到的子目录和文件全部进行显示

```
# find . -name "*.c"         #将目前目录及其子目录下所有延伸档名是 c 的文件列出来
# find . -type f         #将目前目录其其下子目录中所有一般文件列出
# find . -ctime -20         #将目前目录及其子目录下所有最近 20 天内更新过的文件列出
# find /var/log -type f -mtime +7 -ok rm {} \;			#查找/var/log目录中更改时间在7日以前的普通文														 件，并在删除之前询问它们
# find . -type f -perm 644 -exec ls -l {} \;			#查找当前目录中文件属主具有读、写权限，并且文件														所属组的用户和其他用户具有读权限的文件
# find / -type f -size 0 -exec ls -l {} \;#为了查找系统中所有文件长度为0的普通文件，并列出它们的完整路径
```

- -ctime n : 在过去n天内被修改过的文件
- -name name, -iname name : 文件名称符合 name 的文件。iname 会忽略大小写
- -type c : 文件类型是 c 的文件
- -size n : 文件大小 是 n 单位，b 代表 512 位元组的区块，c 表示字元数，k 表示 kilo bytes，w 是二个位元组

### grep命令

用于查找文件里符合条件的字符串，如果发现某文件的内容符合所指定的范本样式，预设 grep 指令会把含有范本样式的那一列显示出来。若不指定任何文件名称，或是所给予的文件名为 **-**，则 grep 指令会从标准输入设备读取数据

```
grep test *file   #在当前目录中，查找后缀有 file 字样的文件中包含 test 字符串的文件，并打印出该字符串的行
grep -r update /etc/acpi         #以递归的方式查找符合条件的文件
grep -v test *test*         #查找文件名中包含 test 的文件中不包含 test 的行
```

- -v 或 --revert-match : 显示不包含匹配文本的所有行
- －n：显示匹配行及行号
- －i：不区分大小写（只适用于单字符）
- －h：查询多文件时不显示文件名

### file命令

用于辨识文件类型

```
# file install.log
# file -b -i install.log
```

- -b 列出辨识结果时，不显示文件名称
- -i 显示MIME类别
- -L  直接显示符号连接所指向的文件的类别

### ps命令

用于显示当前进程 (process) 的状态

```
# ps -A         //显示进程信息
# ps -u root         //显示root进程用户信息
# ps -ef         //显示所有命令，连带命令行
# ps aux         //显示所有包含其他使用者的行程
```

- -A 列出所有的行程
- a 显示现行终端机下的所有程序，包括其他用户的程序
- u 以用户为主的格式来显示程序状况
-  x 显示所有程序，不以终端机来区分
- -f 用ASCII字符显示树状结构，表达程序间的相互关系
- -e 此参数的效果和指定"A"参数相同

### tar命令

压缩文件

```
# touch a.c       
# tar -czvf test.tar.gz a.c   //压缩 a.c 文件为 test.tar.gz
a.c
```

解压文件

```
# tar xzf file.tar.gz        //使用 Gzip 解压 tar 文件 
# tar xjf file.tar.bz2        //使用 Bzip2 解压 tar 文件
# tar -xzvf test.tar.gz     //解压文件
a.c
# tar -tzvf test.tar.gz    //列出压缩文件内容（不解压）
-rw-r--r-- root/root     0 2010-05-24 16:51:59 a.c
```

- -x或--extract或--get 从备份文件中还原文件 
- -z或--gzip或--ungzip 通过gzip指令处理备份文件 
- -v或--verbose 显示指令执行过程 
- -f<备份文件>或--file=<备份文件> 指定备份文件
- -t或--list 列出备份文件的内容
- -c或--create 建立新的备份文件

杀死所有名为proc的进程

```
killall proc 
```

sudo命令以系统管理者的身份执行指令

### Crontab 命令

被用来提交和管理用户的需要周期性执行的任务，当安装完成操作系统后，默认会安装此服务工具，并且会自动启动crond进程，crond进程每分钟会定期检查是否有要执行的任务，如果有要执行的任务，则自动执行该任务。

时程表的格式如下：

```
f1 f2 f3 f4 f5 program
```

- 其中 f1 是表示分钟，f2 表示小时，f3 表示一个月份中的第几日，f4 表示月份，f5 表示一个星期中的第几天。program 表示要执行的程序。
- 当 f1 为 * 时表示每分钟都要执行 program，f2 为 * 时表示每小时都要执行程序，其馀类推
- 当 f1 为 a-b 时表示从第 a 分钟到第 b 分钟这段时间内要执行，f2 为 a-b 时表示从第 a 到第 b 小时都要执行，其馀类推
- 当 f1 为 */n 时表示每 n 分钟个时间间隔执行一次，f2 为 */n 表示每 n 小时个时间间隔执行一次，其馀类推
- 当 f1 为 a, b, c,... 时表示第 a, b, c,... 分钟要执行，f2 为 a, b, c,... 时表示第 a, b, c...个小时要执行，其馀类推

```
0 * * * * /bin/ls         #每月每天每小时的第 0 分钟执行一次 /bin/ls
0 6-12/3 * 12 * /usr/bin/backup         #在 12 月内, 每天的早上 6 点到 12 点，每隔 3 个小时 0 分钟
0 17 * * 1-5 mail -s "hi" alex@domain.name < /tmp/maildata         #周一到周五每天下午 5:00 寄一封信																  给 alex@domain.name
20 0-23/2 * * * echo "haha"         #每月每天的午夜 0 点 20 分, 2 点 20 分, 4 点 20 分....
0 */2 * * * /sbin/service httpd restart         #意思是每两个小时重启一次apache 
```

**注意：**当程序在你所指定的时间执行后，系统会寄一封信给你，显示该程序执行的内容，若是你不希望收到这样的信，请在每一行空一格之后加上 > /dev/null 2>&1 即可

AWK是一种处理文本文件的语言，是一个强大的文本分析工具

Uptime：查询服务器已经运行多久

Netstat: 显示网络状态，利用netstat可以让你得知整个Linux系统的网络情况

top命令用于显示所有正在运行的进程

### 重要的例子

```
echo "$2"  |  passwd  ‐‐stdin  "$1"         # 给设置密码命令传参数
mem_size=$(free | awk '/Mem/{print $4}')         # 提取内存剩余空间
```

竖直号（|）为管道命令，是指 | 的左边运行结果 是 |右边的 输入条件或者范围